name: Render Content Farm RealSolve

on:
  # –ó–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ GitHub UI
  workflow_dispatch:
    inputs:
      clip_data:
        description: 'JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –∫–ª–∏–ø–∞'
        required: true
        default: '{"title":"Test","first_line":"GitHub —Ä–µ–Ω–¥–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç!"}'
      
  # –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ push –≤ main
  push:
    branches: [ main ]
    paths: [ 'src/**' ]

jobs:
  render:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        
    - name: Install dependencies
      run: |
        npm install
        npm install @remotion/cli @remotion/bundler @remotion/renderer remotion react react-dom
        npx remotion --version
        
    - name: Render video
      run: |
        mkdir -p output
        npx remotion render src/Root.tsx ZyraRealSolve output/github-render.mp4 \
          --props='${{ github.event.inputs.clip_data || "{\"title\":\"GitHub Test\",\"first_line\":\"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–Ω–¥–µ—Ä!\"}" }}' \
          --overwrite
          
    - name: Upload rendered video
      uses: actions/upload-artifact@v4
      with:
        name: zyra-realsolve-${{ github.run_number }}
        path: output/github-render.mp4
        retention-days: 7
        
    - name: Show result
      run: |
        echo "‚úÖ –†–µ–Ω–¥–µ—Ä –∑–∞–≤–µ—Ä—à–µ–Ω!"
        echo "üìÅ –í–∏–¥–µ–æ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ Artifacts"
        ls -la output/
